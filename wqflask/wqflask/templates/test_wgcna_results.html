{% extends "base.html" %}
{% block title %}WCGNA results{% endblock %}
{% block content %}
<!-- Start of body -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/xterm/3.14.5/xterm.min.css" integrity="sha512-iLYuqv+v/P4u9erpk+KM83Ioe/l7SEmr7wB6g+Kg1qmEit8EShDKnKtLHlv2QXUp7GGJhmqDI+1PhJYLTsfb8w==" crossorigin="anonymous" referrerpolicy="no-referrer" />

<link rel="stylesheet" href="https://cdn.datatables.net/1.11.3/css/jquery.dataTables.min.css">







<style>
#terminal {

    max-width: 768px;

    margin: 10px;

}
</style>
<style type="text/css">
.container {
    min-height: 100vh;
    width: 100vw;
    padding: 20px;

}

.grid_container {


    width: 80vw;
    margin: auto;
    padding: 20px;


    display: grid;
    grid-template-columns: repeat(7, 1fr);
    /*grid-gap: 5px;*/
    border: 1px solid black;
    grid-column-gap: 20px;

}

.control_sft_column {
    text-align: center;
}

.grid_container div:not(:last-child) {
    border-right: 1px solid #000;
}

.grid_container .control_sft_column h3 {
    font-weight: bold;
    font-size: 18px;
}

.control_net_colors {

    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    align-items: center;
    text-align: center;
}


.control_mod_eigens {
    display: grid;
    grid-template-columns: repeat(2, 200px);
}
</style>
<div class="container">
    <div>
        <div id="terminal">
        </div>
    </div>
    <div>
        <div class="grid_container">
            {% for key, value in results["data"]["output"]["soft_threshold"].items()%}
            <div class="control_sft_column">
                <h3>{{key}}</h3>
                {% for val in value %}
                <p>{{val|round(3)}}</p>
                {% endfor %}
            </div>
            {% endfor %}
        </div>
        <div>
<!--             <h3>Net colors</h3>
            <div class="control_net_colors">
                {% for key,value in results["data"]["output"]["net_colors"].items() %}
                <div style="background-color:{{value}}">
                    <p>{{key}}</p>
                    <p>{{value}}</p>
                </div>
                {% endfor %}
            </div> -->
        </div>
        <div>
            
            <!-- end -->
            <div>
                <a href="/tmp/{{ results['data']['output']['imageLoc'] }}">
                    CLuster dendogram
                </a>
            </div>
        </div>

        <div>
            <h2 style="text-align:center;"> Module eigen genes </h2>
            <table id="example" class="display" width="80vw"></table>
        </div>
    </div>
</div>

{% endblock %}

{% block js %}

<script src="https://cdnjs.cloudflare.com/ajax/libs/xterm/3.14.5/xterm.min.js"></script>

<script language="javascript" type="text/javascript" src="{{ url_for('js', filename='DataTables/js/jquery.js') }}"></script>
<script language="javascript" type="text/javascript" src="{{ url_for('js', filename='DataTables/js/jquery.dataTables.min.js') }}"></script>
<script language="javascript" type="text/javascript" src="{{ url_for('js', filename='DataTablesExtensions/scroller/js/dataTables.scroller.min.js') }}"></script>

<script>
let results = {{results|safe}}

let terminalOutput = results.output

let term = new Terminal({ cursorBlink: true, lineHeight: 1.2 });
term.open(document.getElementById('terminal'));
term.setOption('theme', {
    background: '#300a24'
});

terminalOutput.split('\n').forEach((line) => {
    term.writeln(line)
});
</script>

<script type="text/javascript">



let {col_names,mod_dataset} = {{data|safe}}

$(document).ready(function(){
    $('#example').DataTable( {
        data: mod_dataset,
        columns: col_names.map((name)=>{
            return {
                title:name
            }
        })
    } );
})



</script>





{% endblock %}